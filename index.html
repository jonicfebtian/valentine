<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For Hana ü§ç</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif}

body{
  background:radial-gradient(circle at top,#1a0033,#05000d 80%);
  color:white;
  overflow:hidden;
}

canvas{position:fixed;inset:0;z-index:0}

.wrapper{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
  position:relative;
  z-index:2;
}

.card{
  background:rgba(255,255,255,.07);
  backdrop-filter:blur(18px);
  border-radius:26px;
  padding:26px 24px;
  max-width:380px;
  width:100%;
  text-align:center;
  box-shadow:0 0 60px rgba(170,120,255,.28);
  animation:fadeUp 1.2s ease;
  max-height:90vh;
  overflow-y:auto;
  scrollbar-width:thin;
}

@keyframes fadeUp{
  from{opacity:0;transform:translateY(30px)}
  to{opacity:1;transform:translateY(0)}
}

h1{
  font-family:'Playfair Display',serif;
  font-weight:600;
  letter-spacing:1px;
  margin-bottom:12px;
}

p{
  line-height:1.75;
  font-size:15px;
  opacity:.95;
}

button{
  margin-top:18px;
  padding:12px 28px;
  border:none;
  border-radius:30px;
  background:linear-gradient(135deg,#ff9dd5,#b47cff,#6f9cff);
  color:#fff;
  font-weight:600;
  font-size:15px;
  cursor:pointer;
  box-shadow:0 0 25px rgba(180,120,255,.45);
  transition:.35s;
}
button:hover{transform:scale(1.05)}
.hide{display:none}

/* ===== VIDEO ===== */
.video-box{
  margin:14px 0 18px;
  border-radius:18px;
  overflow:hidden;
  box-shadow:0 0 35px rgba(160,120,255,.35);
  height:280px;
  position:relative;
  background:#000;
}

.video-box video{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* typing */
#typing{
  margin-top:12px;
  font-size:15px;
  line-height:1.75;
  white-space:pre-line;
}

/* ===== TIC TAC TOE ===== */
#playBtn { margin-top:16px; }
#gameWrap{
  margin-top:18px;
  padding:14px;
  border-radius:18px;
  background:rgba(255,255,255,.06);
  box-shadow:0 0 35px rgba(160,120,255,.22);
}

.game-head{
  font-size:14px;
  opacity:.95;
  line-height:1.5;
  margin-bottom:10px;
}

.board{
  display:grid;
  grid-template-columns:repeat(3, 1fr);
  gap:10px;
  margin:10px auto 12px;
  width:min(300px, 100%);
}

.cell{
  aspect-ratio:1/1;
  border-radius:16px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(255,255,255,.05);
  box-shadow:0 0 18px rgba(160,120,255,.12);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:34px;
  font-weight:700;
  cursor:pointer;
  user-select:none;
  transition:.2s;
}
.cell:hover{ transform:scale(1.02); }
.cell.disabled{ cursor:not-allowed; opacity:.75; }

#gameStatus{
  font-size:14px;
  opacity:.9;
  margin-top:6px;
  line-height:1.5;
}

.small-btn{
  margin-top:10px;
  padding:10px 18px;
  border-radius:999px;
  font-size:14px;
}

#rewardImg{
  margin-top:14px;
  width:100%;
  border-radius:18px;
  overflow:hidden;
  box-shadow:0 0 35px rgba(160,120,255,.30);
  display:block;
}
</style>
</head>

<body>

<canvas id="lux"></canvas>

<div class="wrapper">

<div class="card" id="openCard">
  <h1>Hi Hana ü§ç</h1>
  <p>I made something small for you.<br>Hope it brings a little smile ‚ú®</p>
  <button onclick="openMsg()">Open Message</button>
</div>

<div class="card hide" id="msgCard">
  <h1>Happy Valentine ü§ç</h1>

  <div class="video-box">
    <video autoplay loop muted playsinline>
      <source src="hana.mp4" type="video/mp4">
    </video>
  </div>

  <p id="typing"></p>

  <!-- tombol muncul setelah typing selesai -->
  <button id="playBtn" class="hide" onclick="showGame()">Play Tic Tac Toe ü§ç</button>

  <!-- GAME -->
  <div id="gameWrap" class="hide">
    <div class="game-head">
      Kamu = <b>X</b> &nbsp;|&nbsp; Robot = <b>O</b><br>
      Menang lawan robot dulu ya ‚ú®
    </div>

    <div class="board" id="board"></div>

    <div id="gameStatus">Your turn.</div>

    <button class="small-btn" onclick="resetGame()">Restart Game</button>

    <!-- reward image (muncul kalau player menang) -->
    <img id="rewardImg" class="hide" src="image2.png" alt="image2">
  </div>
</div>

<audio id="music" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

</div>

<script>
function openMsg(){
  document.getElementById("openCard").classList.add("hide");
  document.getElementById("msgCard").classList.remove("hide");
  const music = document.getElementById("music");
  music.play().catch(()=>{ /* ignore autoplay restrictions */ });

  // reset typing setiap buka
  document.getElementById("typing").innerHTML = "";
  document.getElementById("playBtn").classList.add("hide");
  document.getElementById("gameWrap").classList.add("hide");

  i = 0;
  typeWriter();
}

const text = `This is just a simple message,
but I hope you‚Äôll always remember it ü§ç

Thank you for every little conversation,
every random story, and every small moment.
Somehow, they always manage to make my days feel lighter.

Sometimes I catch myself smiling,
sometimes I laugh without realizing,
all because of a simple chat from you.

Thank you for being here,
even when we‚Äôre far apart.
Let‚Äôs just take everything slowly, one step at a time.

I hope life treats you gently,
your days stay kind,
and your dreams slowly find their way.

I hope college feels a little lighter too,
that every late night, deadline, and tired moment
leads you closer to what you‚Äôre chasing.

No matter where life takes you,
or what you choose to do,
I‚Äôll always be proud of you ‚ú®

‚Äî Your number one supporter`;

let i=0;
function typeWriter(){
  if(i<text.length){
    document.getElementById("typing").innerHTML += text.charAt(i);
    i++;
    setTimeout(typeWriter,45);
  } else {
    // selesai typing -> munculin tombol game
    document.getElementById("playBtn").classList.remove("hide");
  }
}

/* ===== TIC TAC TOE vs ROBOT ===== */
let board = Array(9).fill(null);
let gameOver = false;

const boardEl = document.getElementById("board");
const statusEl = document.getElementById("gameStatus");
const rewardImg = document.getElementById("rewardImg");

function showGame(){
  document.getElementById("gameWrap").classList.remove("hide");
  resetGame();
  // auto scroll ke bawah biar keliatan gamenya
  document.getElementById("msgCard").scrollTop = document.getElementById("msgCard").scrollHeight;
}

function renderBoard(){
  boardEl.innerHTML = "";
  board.forEach((val, idx) => {
    const cell = document.createElement("div");
    cell.className = "cell";
    cell.textContent = val ? val : "";
    if(gameOver || val) cell.classList.add("disabled");
    cell.addEventListener("click", () => playerMove(idx));
    boardEl.appendChild(cell);
  });
}

function playerMove(idx){
  if(gameOver) return;
  if(board[idx]) return;

  board[idx] = "X";
  renderBoard();

  const w = getWinner(board);
  if(w) return endGame(w);

  statusEl.textContent = "Robot thinking...";
  setTimeout(() => {
    robotMove();
  }, 350);
}

function robotMove(){
  if(gameOver) return;

  const move = bestMove(board);
  if(move !== -1) board[move] = "O";
  renderBoard();

  const w = getWinner(board);
  if(w) return endGame(w);

  statusEl.textContent = "Your turn.";
}

function endGame(result){
  gameOver = true;

  if(result === "X"){
    statusEl.textContent = "You win! ü§ç";
    rewardImg.classList.remove("hide"); // tampilkan image2.png
  } else if(result === "O"){
    statusEl.textContent = "Robot wins üò≠ try again.";
  } else {
    statusEl.textContent = "Draw! one more round?";
  }

  // disable semua cell
  renderBoard();
}

function resetGame(){
  board = Array(9).fill(null);
  gameOver = false;
  statusEl.textContent = "Your turn.";
  rewardImg.classList.add("hide");
  renderBoard();
}

function getWinner(b){
  const lines = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];
  for(const [a,c,d] of lines){
    if(b[a] && b[a] === b[c] && b[a] === b[d]) return b[a];
  }
  if(b.every(x => x)) return "draw";
  return null;
}

/* Robot AI: minimax (perfect play) */
function bestMove(b){
  let bestScore = -Infinity;
  let move = -1;

  for(let i=0;i<9;i++){
    if(b[i] === null){
      b[i] = "O";
      const score = minimax(b, 0, false);
      b[i] = null;
      if(score > bestScore){
        bestScore = score;
        move = i;
      }
    }
  }
  return move;
}

function minimax(b, depth, isMax){
  const res = getWinner(b);
  if(res){
    if(res === "O") return 10 - depth;
    if(res === "X") return depth - 10;
    return 0;
  }

  if(isMax){
    let best = -Infinity;
    for(let i=0;i<9;i++){
      if(b[i] === null){
        b[i] = "O";
        best = Math.max(best, minimax(b, depth+1, false));
        b[i] = null;
      }
    }
    return best;
  } else {
    let best = Infinity;
    for(let i=0;i<9;i++){
      if(b[i] === null){
        b[i] = "X";
        best = Math.min(best, minimax(b, depth+1, true));
        b[i] = null;
      }
    }
    return best;
  }
}

/* galaxy particles */
const c=document.getElementById("lux");
const ctx=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight}
resize();onresize=resize;

let stars=[];
for(let i=0;i<140;i++){
  stars.push({
    x:Math.random()*c.width,
    y:Math.random()*c.height,
    r:Math.random()*1.4+.3,
    s:Math.random()*0.25+.05
  })
}

function draw(){
  ctx.clearRect(0,0,c.width,c.height);
  for(let s of stars){
    ctx.beginPath();
    ctx.fillStyle="rgba(200,160,255,.65)";
    ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    ctx.fill();
    s.y-=s.s;
    if(s.y<0){
      s.y=c.height;
      s.x=Math.random()*c.width;
    }
  }
  requestAnimationFrame(draw);
}
draw();
</script>

</body>
</html>
